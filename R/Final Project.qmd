---
title: "Final Project"
author: "Taylor Nguyen"
format: html
---

```{r}
here::here()
```
# Install and load packages
```{r}
install.packages("here")
install.packages("gtsummary")
install.packages("renv")
install.packages("yaml")

library(tidyverse)
library(gtsummary)
library(broom)

sauces_col <- c("season", "sauce_number", "sauce_name", "scoville")
sauces <- read_csv(here::here("data", "raw", "sauces.csv"),
								 skip = 1, col_names = sauces_col) |>
	mutate(saucenum = factor(sauce_number, labels = (1:10)),
				 season = factor(season, labels = c("Season 1", "Season 2", "Season 3", "Season 4", "Season 5",
																					"Season 6", "Season 7", "Season 8", "Season 9", "Season 10",
																					"Season 11", "Season 12", "Season 13", "Season 14", "Season 15",
																					"Season 16", "Season 17", "Season 18", "Season 19", "Season 20",
																					"Season 21")))
```

# Renv
renv::init()
renv::snapshot()
source("renv/activate.R")

renv::restore()
renv::status()

# Read in data to R
sauce_data <- read.csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-08-08/sauces.csv")
view(sauce_data)

The sauces dataset involves Hot Ones sauces that have been tried over the 21 seasons and their Scoville Heat Unit.
																					
# Customization of `tbl_summary()`

```{r}
tbl_summary(
	sauces,
	by = season,
	include = c(season, saucenum, sauce_name, scoville))
```

```{r}
#| label: tbl-one
#| tbl-cap: "Hot Ones Sauces Over the Seasons"
table1 <- tbl_summary(
	sauces,
	by = season,
	include = c(season, saucenum, sauce_name, scoville),
	label = list(
		seasonnum ~ "Number of Season",
		sauce_name ~ "Sauce Name",
		scoville ~ "Scoville"
		),
		missing_text = "Missing")
table1
```
@tbl-one looks at different sauces used for each Hot Ones season

```{r}
#| label: tbl-one
#| tbl-cap: "The table displays Hot Ones sauces over the seasons"
knitr::kable(sauces)
```

```{r}
#| label: tbl-two
#| tbl-cap: "Descriptive Statistics"
table2 <- tbl_summary(
	sauces,
	by = season,
	include = c(season, saucenum, sauce_name, scoville)) |>
	add_overall(last = TRUE)
table2
```

```{r}
#| label: fig-hist
#| fig-cap: "This is a histogram of Hot Ones sauces"
hist(sauces$scoville)
```
@fig-hist contains a histogram of Hot Ones sauces and @tbl-one a table of Hot Ones sauces over the seasons.

```{r}
scoville_szn <- inline_text(table1, variable = "Scoville", 
                        						 column = "Season")
scoville_saucename <- inline_text(table1, variable = "Scoville", 
                        						 column = "Sauce Name")
```
A greater proportion of season (`r scoville_szn`) than sauce name (`r scoville_saucename`) had more scoville.

A greater proportion of season (`r inline_text(table1, variable = "Scoville", column = "Season")`) than sauce name (`r inline_text(table1, variable = "Scoville", column = "Sauce Name")`) had more scoville.

There were `r 200 + 10` participants 

```{r}
scoville_avg <- mean(sauces$scoville, na.rm = TRUE)
```
The average amount of scoville was 'r scoville_avg'

sauce_stats <- list(n = nrow(sauces),
										scoville_avg = mean(sauces$scoville))
There were `r sauce_stats$n` sauces with a mean scoville of `r sauce_stats$scoville_avg`.

```{r}
tbl_summary(
 	sauces,
 	by = season,
 	include = c(season, saucenum, sauce_name, scoville),
 	label = list(
 		seasonnum ~ "Season Number",
 		sauce_name ~ "Sauce Name",
 		scoville ~ "Scoville") |>
 	add_p(test = list(all_continuous() ~ "t.test",
										all_categorical() ~ "chisq.test")) |>
	add_overall(col_label = "**Total**") |>
 	bold_labels() |>
 	modify_footnote(update = everything() ~ NA) |>
 	modify_header(label = "**Variable**"), p.value(label = "**P**"))
```
 	
# Univariate regression
```{r}
#| label: regress
#| tbl-cap: "Regression Results"
regress1 <- tbl_uvregression(
	sauces,
	y = scoville,
	include = c(season, saucenum, sauce_name, scoville),
	method = lm)
regress1
```
@regress is a univariate regression for the sauces dataset	
	
# Multivariable regressions
```{r}
linear_model <- lm(scoville ~ season + saucenum + sauce_name,
									 data = sauces)
```

```{r}									 
linear_model_int <- lm(scoville ~ season*saucenum + sauce_name,
											 data = sauces)
```

# Regression Tables

```{r}
tbl_regression(
	linear_model,
	intercept = TRUE,
	label = list(
		season ~ "Season",
		saucenum ~ "Sauce Number",
		sauce_name ~ "Sauce Name"
	))
```

```{r}
tbl_no_int <- tbl_regression(
  linear_model, 
  intercept = TRUE,
  label = list(
  	season ~ "Season",
		saucenum ~ "Sauce Number",
		sauce_name ~ "Sauce Name"
	))

tbl_int <- tbl_regression(
   linear_model_int, 
   intercept = TRUE,
   label = list(
 		season ~ "Season",
 		saucenum ~ "Sauce Number",
 		sauce_name ~ "Sauce Name",
 		`season:sauce_name` ~ "Season/Sauce Name Interaction"
 	))
```

```{r}
tbl_merge(list(tbl_no_int, tbl_int), 
          tab_spanner = c("**Model 1**", "**Model 2**"))
```
	
